<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Planificaci√≥n de Materias</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    .unidad-container {
      border: 1px solid #ccc;
      padding: 10px;
      margin-top: 10px;
      border-radius: 5px;
    }
    .tema-container {
      margin-left: 20px;
      margin-top: 10px;
      border-left: 3px solid #eee;
      padding-left: 10px;
    }
    input { margin: 5px 0; display: block; }
    button { margin: 5px 5px 15px 0; }
  </style>
</head>
<body>

  <h2>Crear Materia</h2>

  <label>Nombre de la Materia:</label>
  <input type="text" id="materiaNombre" placeholder="Ej. Matem√°ticas" />

  <label>Horas necesarias por semana:</label>
  <input type="number" id="horasSemana" placeholder="Ej. 4" min="1" />

  <div id="unidadesContainer"></div>

  <button id="btnAgregarUnidad">‚ûï A√±adir Unidad</button>

  <hr />
  <button id="guardarTodo">üíæ Guardar Todo</button>

  <script>
    let contadorUnidades = 0;

    const unidadesContainer = document.getElementById("unidadesContainer");
    const btnAgregarUnidad = document.getElementById("btnAgregarUnidad");
    const btnGuardar = document.getElementById("guardarTodo");

    btnAgregarUnidad.addEventListener("click", () => {
      contadorUnidades++;
      const unidadDiv = document.createElement("div");
      unidadDiv.className = "unidad-container";

      unidadDiv.innerHTML = `
        <label>Nombre de la Unidad:</label>
        <input type="text" class="unidad-nombre" placeholder="Ej. √Ålgebra" />

        <div class="temas-container"></div>

        <button class="btnAgregarTema">‚ûï A√±adir Tema</button>
      `;

      unidadesContainer.appendChild(unidadDiv);

      const btnTema = unidadDiv.querySelector(".btnAgregarTema");
      const temasContainer = unidadDiv.querySelector(".temas-container");

      btnTema.addEventListener("click", () => {
        const temaDiv = document.createElement("div");
        temaDiv.className = "tema-container";
        temaDiv.innerHTML = `
          <label>Nombre del Tema:</label>
          <input type="text" class="tema-nombre" placeholder="Ej. Ecuaciones cuadr√°ticas" />

          <label>Horas necesarias para cubrir el tema:</label>
          <input type="number" class="tema-horas" placeholder="Ej. 2" min="1" />
        `;
        temasContainer.appendChild(temaDiv);
      });
    });

    btnGuardar.addEventListener("click", () => {
      if (!confirm("¬øDeseas continuar con el guardado?")) return;

      const materiaNombre = document.getElementById("materiaNombre").value.trim();
      const horasSemana = document.getElementById("horasSemana").value.trim();

      if (!materiaNombre || !horasSemana) {
        alert("‚ö†Ô∏è Por favor completa todos los campos de la materia.");
        return;
      }

      const unidades = [];
      const unidadDivs = unidadesContainer.querySelectorAll(".unidad-container");

      for (const unidad of unidadDivs) {
        const nombreUnidad = unidad.querySelector(".unidad-nombre").value.trim();
        if (!nombreUnidad) {
          alert("‚ö†Ô∏è Faltan campos por rellenar en alguna unidad.");
          return;
        }

        const temas = [];
        const temaDivs = unidad.querySelectorAll(".tema-container");

        for (const tema of temaDivs) {
          const nombreTema = tema.querySelector(".tema-nombre").value.trim();
          const horasTema = tema.querySelector(".tema-horas").value.trim();

          if (!nombreTema || !horasTema) {
            alert("‚ö†Ô∏è Faltan campos por rellenar en alg√∫n tema.");
            return;
          }

          temas.push({ nombre: nombreTema, horas: Number(horasTema) });
        }

        unidades.push({ unidad: nombreUnidad, temas });
      }

      const data = {
        materia: materiaNombre,
        horasSemana: Number(horasSemana),
        unidades,
      };

      // Guardar en localStorage pero no redirigir ni mostrar reporte
      //localStorage.setItem("planificacionMateria", JSON.stringify(data));
      alert("‚úÖ Datos guardados correctamente."); // Confirmaci√≥n de guardado
    });
  </script>

</body>
</html>
